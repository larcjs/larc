<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PAN DevTools Extension - Now Enabled! ‚úÖ ¬∑ PAN Documentation</title>
  <meta name="description" content="PAN (Page Area Network) Documentation - PAN DevTools Extension - Now Enabled! ‚úÖ">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="../assets/theme.css">
  <link rel="stylesheet" href="../assets/docs.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css" integrity="sha384-wH75j6z1lH97ZOpMOInqhgKzFkAInZPPSPlZpYKYTOqsaizPvhQZmAtLcPKXpLyH" crossorigin="anonymous">
</head>
<body>
  <header class="docs-header">
    <div class="docs-header-content">
      <a href="../index.html" class="logo">
        <span>PAN</span>
      </a>
      <nav class="docs-nav">
        <a href="../index.html">Home</a>
        <a href="index.html" class="active">Docs</a>
        <a href="../examples.html">Examples</a>
        <a href="../apps.html">Apps</a>
        <a href="https://github.com/chrisrobison/pan" target="_blank">GitHub</a>
      </nav>
    </div>
  </header>

  <div class="docs-layout">
    <aside class="docs-sidebar">
      <div class="docs-sidebar-content">
        <h3>Documentation</h3>
        <nav class="docs-menu" id="docs-menu">
          <!-- Will be populated by JavaScript -->
        </nav>
      </div>
    </aside>

    <main class="docs-main">
      <div class="docs-breadcrumb">
        <a href="../index.html">Home</a> / <a href="#">packages</a> / <a href="#">devtools</a> / <span>EXTENSION_ENABLED</span>
      </div>
      <article class="docs-content">
        <h1>PAN DevTools Extension - Now Enabled! ‚úÖ</h1>
<h2>What We Fixed</h2>
<p>The chrome-devtools MCP server is now configured to load the PAN DevTools extension automatically when launching Chrome.</p>
<h2>Configuration Applied</h2>
<p>Updated: <code>/Users/cdr/Library/Application Support/Claude/claude_desktop_config.json</code></p>
<pre><code class="language-json">{
  &quot;mcpServers&quot;: {
    &quot;chrome-devtools&quot;: {
      &quot;command&quot;: &quot;npx&quot;,
      &quot;args&quot;: [
        &quot;chrome-devtools-mcp&quot;,
        &quot;--chrome-arg=--load-extension=/Users/cdr/Projects/larc-repos/devtools&quot;,
        &quot;--chrome-arg=--disable-extensions-except=/Users/cdr/Projects/larc-repos/devtools&quot;
      ]
    }
  }
}</code></pre>
<h2>How It Works</h2>
<h3>The Solution</h3>
The chrome-devtools-mcp server uses <strong>Puppeteer</strong> (not Playwright) and supports passing custom Chrome arguments via <code>--chrome-arg</code>.
<strong>Key Arguments</strong>:
<li><code>--load-extension=/path/to/extension</code> - Tells Chrome to load the specified extension</li>
<li><code>--disable-extensions-except=/path/to/extension</code> - Disables all other extensions except this one</li>
<h3>Why This Works</h3>
From the chrome-devtools-mcp source code (<code>browser.js</code> line 72-98):
<pre><code class="language-javascript">const args = [
  ...(options.args ?? []),  // &lt;-- Custom args passed here
  &#039;--hide-crash-restore-bubble&#039;,
];

const browser = await puppeteer.launch({
  channel: puppeteerChannel,
  targetFilter: makeTargetFilter(),
  executablePath,
  defaultViewport: null,
  userDataDir,
  pipe: true,
  headless,
  args,  // &lt;-- Args applied to Chrome launch
  acceptInsecureCerts: options.acceptInsecureCerts,
  handleDevToolsAsPage: true,
});</code></pre>
<p>The <code>--chrome-arg</code> CLI option (defined in <code>cli.js</code> line 135-138) allows passing any Chrome command-line flag.</p>
<h2>Next Steps</h2>
<h3>1. Restart Claude Desktop</h3>
The MCP server configuration is only loaded when Claude Desktop starts. You need to:
<li><strong>Quit Claude Desktop completely</strong> (Cmd+Q)</li>
<li><strong>Reopen Claude Desktop</strong></li>
<li>Wait for MCP servers to initialize</li>
<h3>2. Test the Extension</h3>
<p>Once restarted, use the chrome-devtools MCP tools:</p>
<pre><code class="language-javascript">// Navigate to playground
mcp__chrome-devtools__navigate_page({ type: &quot;url&quot;, url: &quot;http://localhost:8080/playground/&quot; })

// Load an example (e.g., Drag &amp; Drop List)
// Then check console for extension logs
mcp__chrome-devtools__list_console_messages()</code></pre>
<strong>Expected Console Output</strong>:
<pre><code class="language-plaintext">[PAN DevTools] Injected and monitoring PAN messages</code></pre>
<h3>3. Verify Extension Loaded</h3>
<p>Check that the extension API is available:</p>
<pre><code class="language-javascript">mcp__chrome-devtools__evaluate_script({
  function: &quot;() =&gt; { return { devTools: window.__panDevTools ? &#039;loaded&#039; : &#039;missing&#039; }; }&quot;
})</code></pre>
<strong>Expected Result</strong>:
<pre><code class="language-json">{&quot;devTools&quot;: &quot;loaded&quot;}</code></pre>
<h3>4. Check DevTools Panel</h3>
<li>Open Chrome DevTools (F12 or Cmd+Option+I)</li>
<li>Look for the <strong>"PAN"</strong> tab in the top toolbar</li>
<li>Interact with playground components</li>
<li>See PAN messages appear in real-time</li>
<h2>Extension Features</h2>
<p>Once loaded, the PAN DevTools extension provides:</p>
<h3>Console Logging</h3>
<pre><code class="language-plaintext">[PAN DevTools] Intercepted event: pan:publish {topic: &quot;list.reorder&quot;, ...}
[PAN DevTools] Posting message to content script: {...}</code></pre>
<h3>DevTools Panel</h3>
<ul><li>Real-time message display</li>
<li>Message filtering by type/topic</li>
<li>Component inspection</li>
<li>Message replay capability</li>
<li>Statistics dashboard</li>
</ul>
<h3>Browser API</h3>
Available at <code>window.__panDevTools</code>:
<pre><code class="language-javascript">window.__panDevTools.getHistory()      // Get all captured messages
window.__panDevTools.clearHistory()    // Clear message history
window.__panDevTools.getComponents()   // List all PAN components
window.__panDevTools.getStats()        // Get message statistics
window.__panDevTools.replay(messageId) // Replay a specific message</code></pre>
<h2>Troubleshooting</h2>
<h3>Extension Not Loading</h3>
<p>If you don't see the extension after restart:</p>
<li><strong>Check Chrome launched by MCP</strong>:</li>
   - Use chrome-devtools tools to navigate to <code>chrome://extensions/</code>
   - Verify PAN DevTools appears in the list
<li><strong>Check console for errors</strong>:</li>
   <pre><code class="language-javascript">mcp__chrome-devtools__list_console_messages()</code></pre>
   Look for extension-related errors
<li><strong>Verify extension path</strong>:</li>
   <pre><code class="language-bash">ls -la /Users/cdr/Projects/larc-repos/devtools/manifest.json</code></pre>
   Should exist and be readable
<li><strong>Check manifest.json is valid</strong>:</li>
   <pre><code class="language-bash">cat /Users/cdr/Projects/larc-repos/devtools/manifest.json | jq .</code></pre>
   Should parse without errors
<h3>Extension Loads But No Messages</h3>
<p>If extension loads but doesn't capture messages:</p>
<li><strong>Check injected script loaded</strong>:</li>
   - Console should show: <code>[PAN DevTools] Injected and monitoring PAN messages</code>
   - If missing, check content script injection in manifest.json
<li><strong>Verify PAN Bus is active</strong>:</li>
   - Console should show: <code>[PAN Bus] PAN Bus Enhanced ready</code>
   - Components should register: <code>[PAN Bus] Client registered</code>
<li><strong>Check event listeners</strong>:</li>
   <pre><code class="language-javascript">// In console
   console.log(&#039;pan:publish listeners:&#039;,
     getEventListeners(document)[&#039;pan:publish&#039;]?.length || 0
   );</code></pre>
<h2>Alternative: Manual Testing</h2>
<p>To test the extension outside of MCP:</p>
<pre><code class="language-bash"># Launch Chrome with extension manually
/Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome \
  --load-extension=/Users/cdr/Projects/larc-repos/devtools \
  --disable-extensions-except=/Users/cdr/Projects/larc-repos/devtools \
  --user-data-dir=/tmp/chrome-extension-test \
  http://localhost:8080/playground/</code></pre>
<h2>Configuration Options</h2>
<h3>Use a Persistent User Data Directory</h3>
<p>To maintain extension settings across sessions:</p>
<pre><code class="language-json">{
  &quot;chrome-devtools&quot;: {
    &quot;command&quot;: &quot;npx&quot;,
    &quot;args&quot;: [
      &quot;chrome-devtools-mcp&quot;,
      &quot;--chrome-arg=--load-extension=/Users/cdr/Projects/larc-repos/devtools&quot;,
      &quot;--chrome-arg=--disable-extensions-except=/Users/cdr/Projects/larc-repos/devtools&quot;,
      &quot;--user-data-dir=/Users/cdr/.chrome-devtools-profile&quot;
    ]
  }
}</code></pre>
<h3>Launch with DevTools Open</h3>
<p>Auto-open DevTools on each page:</p>
<pre><code class="language-json">{
  &quot;chrome-devtools&quot;: {
    &quot;command&quot;: &quot;npx&quot;,
    &quot;args&quot;: [
      &quot;chrome-devtools-mcp&quot;,
      &quot;--chrome-arg=--load-extension=/Users/cdr/Projects/larc-repos/devtools&quot;,
      &quot;--chrome-arg=--disable-extensions-except=/Users/cdr/Projects/larc-repos/devtools&quot;,
      &quot;--chrome-arg=--auto-open-devtools-for-tabs&quot;
    ]
  }
}</code></pre>
<h3>Use Chrome Canary</h3>
<p>If you want to test with Chrome Canary:</p>
<pre><code class="language-json">{
  &quot;chrome-devtools&quot;: {
    &quot;command&quot;: &quot;npx&quot;,
    &quot;args&quot;: [
      &quot;chrome-devtools-mcp&quot;,
      &quot;--channel=canary&quot;,
      &quot;--chrome-arg=--load-extension=/Users/cdr/Projects/larc-repos/devtools&quot;,
      &quot;--chrome-arg=--disable-extensions-except=/Users/cdr/Projects/larc-repos/devtools&quot;
    ]
  }
}</code></pre>
<h2>Technical Details</h2>
<h3>MCP Server Architecture</h3>
<pre><code class="language-plaintext">Claude Desktop
    ‚Üì
claude_desktop_config.json
    ‚Üì
npx chrome-devtools-mcp (with --chrome-arg flags)
    ‚Üì
Puppeteer.launch(args: [...custom chrome args])
    ‚Üì
Chrome Browser (with PAN DevTools extension loaded)</code></pre>
<h3>Extension Components</h3>
<li><strong>manifest.json</strong> - Extension configuration (Manifest V3)</li>
<li><strong>injected.js</strong> - Runs in page context, intercepts PAN events</li>
<li><strong>content-script.js</strong> - Bridge between page and extension</li>
<li><strong>devtools.js</strong> - Creates DevTools panel</li>
<li><strong>panel.html</strong> - DevTools panel UI</li>
<h3>Message Flow</h3>
<pre><code class="language-plaintext">Component publishes PAN message
    ‚Üì
document.dispatchEvent(new CustomEvent(&#039;pan:publish&#039;, ...))
    ‚Üì
injected.js intercepts via EventTarget.prototype.dispatchEvent
    ‚Üì
window.postMessage({ type: &#039;PAN_MESSAGE&#039;, data: ... })
    ‚Üì
content-script.js receives message
    ‚Üì
chrome.runtime.sendMessage() to background/devtools
    ‚Üì
DevTools panel displays message</code></pre>
<h2>Benefits</h2>
<h3>Before Configuration</h3>
<ul><li>‚ùå Extension not loading</li>
<li>‚ùå No DevTools panel</li>
<li>‚ùå Manual reload required</li>
<li>‚úÖ PAN Monitor works (in-page alternative)</li>
</ul>
<h3>After Configuration</h3>
<ul><li>‚úÖ Extension loads automatically</li>
<li>‚úÖ DevTools panel available</li>
<li>‚úÖ Real-time message capture</li>
<li>‚úÖ No manual intervention needed</li>
<li>‚úÖ PAN Monitor still works (both tools available)</li>
</ul>
<h2>Summary</h2>
<p>The PAN DevTools extension is now properly configured to load with the chrome-devtools MCP server. After restarting Claude Desktop, you'll have full DevTools integration for debugging PAN messages in the playground!</p>
<strong>Key Achievement</strong>: We discovered that chrome-devtools-mcp already supports custom Chrome args, so no source code modification was needed - just proper configuration! üéâ
      </article>
      <footer class="docs-footer">
        <a href="https://github.com/chrisrobison/pan/edit/main/devtools/EXTENSION_ENABLED.md" target="_blank">
          Edit this page on GitHub
        </a>
      </footer>
    </main>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js" integrity="sha384-F/bZzf7p3Joyp5psL90p/p89AZJsndkSoGwRpXcZhleCWhd8SnRuoYo4d0yirjJp" crossorigin="anonymous"></script>
  <script src="../assets/docs.js"></script>
</body>
</html>