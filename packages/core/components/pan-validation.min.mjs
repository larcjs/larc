function b(e){try{return JSON.stringify(e),!0}catch{return!1}}function c(e){if(e===void 0)return{valid:!0};if(typeof e=="function")return{valid:!1,error:"Functions cannot be serialized"};if(e instanceof Node||e instanceof Element)return{valid:!1,error:"DOM nodes cannot be serialized"};if(e instanceof Window)return{valid:!1,error:"Window objects cannot be serialized"};try{return JSON.stringify(e),{valid:!0}}catch(r){return r.message.includes("circular")?{valid:!1,error:"Circular references are not allowed"}:r.message.includes("BigInt")?{valid:!1,error:"BigInt values are not JSON-serializable (convert to string first)"}:{valid:!1,error:`Serialization error: ${r.message}`}}}function f(e){try{const r=JSON.stringify(e);return new Blob([r]).size}catch{return 0}}function d(e){return!e||typeof e!="string"?{valid:!1,error:"Topic must be a non-empty string"}:e.length>256?{valid:!1,error:"Topic must be less than 256 characters"}:/^[a-z0-9:.*_-]+$/i.test(e)?e.includes("..")?{valid:!1,error:"Topic cannot contain consecutive dots"}:e.startsWith(".")||e.endsWith(".")?{valid:!1,error:"Topic cannot start or end with a dot"}:{valid:!0}:{valid:!1,error:"Topic can only contain letters, numbers, dots, colons, hyphens, underscores, and asterisks"}}function y(e,r={}){const{allowGlobalWildcard:s=!0,maxWildcards:t=5}=r,i=d(e);if(!i.valid)return i;if(e==="*")return s?{valid:!0}:{valid:!1,error:"Global wildcard (*) is disabled for security reasons"};const n=(e.match(/\*/g)||[]).length;if(n>t)return{valid:!1,error:`Too many wildcards (${n}), maximum is ${t}`};const o=e.split(".");for(const a of o)if(a.includes("*")&&a!=="*")return{valid:!1,error:'Wildcards must be a complete segment (use "users.*" not "users.u*")'};return{valid:!0}}function p(e,r={}){const{maxMessageSize:s=1048576,maxPayloadSize:t=524288}=r,i=d(e.topic);if(!i.valid)return i;const n=c(e.data);if(!n.valid)return{valid:!1,error:`Data validation failed: ${n.error}`};const o=f(e);if(o>s)return{valid:!1,error:`Message size (${o} bytes) exceeds limit (${s} bytes)`};const a=f(e.data);if(a>t)return{valid:!1,error:`Payload size (${a} bytes) exceeds limit (${t} bytes)`};if(e.id!==void 0&&typeof e.id!="string")return{valid:!1,error:"Message id must be a string"};if(e.ts!==void 0&&typeof e.ts!="number")return{valid:!1,error:"Message timestamp must be a number"};if(e.retain!==void 0&&typeof e.retain!="boolean")return{valid:!1,error:"Message retain must be a boolean"};if(e.replyTo!==void 0){const l=d(e.replyTo);if(!l.valid)return{valid:!1,error:`Invalid replyTo: ${l.error}`}}if(e.correlationId!==void 0&&typeof e.correlationId!="string")return{valid:!1,error:"Message correlationId must be a string"};if(e.headers!==void 0){if(typeof e.headers!="object"||Array.isArray(e.headers))return{valid:!1,error:"Message headers must be an object"};for(const[l,v]of Object.entries(e.headers))if(typeof v!="string")return{valid:!1,error:`Header "${l}" must be a string value`}}return{valid:!0}}function m(e){return!e||!e.isConnected?!1:document.contains(e)||document.body.contains(e)}function u(e){if(!e)return"Unknown error";if(typeof e=="string")return e.replace(/\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Z|a-z]{2,}\b/g,"[email]").replace(/\b\d{4}[-\s]?\d{4}[-\s]?\d{4}[-\s]?\d{4}\b/g,"[card]").replace(/\b\d{3}-\d{2}-\d{4}\b/g,"[ssn]");if(e instanceof Error)return u(e.message);try{return u(String(e))}catch{return"Error cannot be displayed"}}var g={isSerializable:b,checkSerializable:c,estimateSize:f,validateTopic:d,validatePattern:y,validateMessage:p,isElementAlive:m,sanitizeError:u};export{c as checkSerializable,g as default,f as estimateSize,m as isElementAlive,b as isSerializable,u as sanitizeError,p as validateMessage,y as validatePattern,d as validateTopic};
