function u(t={}){const{enforce:e=!0,allowedHosts:o=["localhost","127.0.0.1","[::1]"]}=t;if(!e)return;const n=location.protocol==="https:",r=location.hostname,c=o.some(s=>r===s);if(!n&&!c){console.error("\u{1F512} PAN Security: HTTPS is required in production"),console.error(`Current URL: ${location.href}`),console.error("Redirecting to HTTPS...");const s=location.hostname,i=location.port,p=location.pathname,d=location.search,S=location.hash;let a=`https://${s}`;i&&i!=="80"&&i!=="443"&&(a+=`:${i}`),a+=p+d+S,location.replace(a)}}function y(t){if(!t||typeof t!="string")return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}function P(t,e){if(t){if(typeof e!="string"){t.textContent="";return}typeof window<"u"&&window.DOMPurify?t.innerHTML=window.DOMPurify.sanitize(e):(t.textContent=e,console.warn("DOMPurify not available. Using textContent. Install DOMPurify for proper HTML sanitization."))}}function T(t){return document.createTextNode(t||"")}function H(t,e={},o=""){const n=document.createElement(t);for(const[r,c]of Object.entries(e)){if(r.startsWith("on")){console.warn(`Skipping event handler attribute: ${r}`);continue}if(["innerHTML","outerHTML"].includes(r)){console.warn(`Skipping dangerous attribute: ${r}`);continue}n.setAttribute(r,c)}return o&&(n.textContent=o),n}function f(t){if(!t||typeof t!="string")return!1;const e=t.trim().toLowerCase(),o=["javascript:","data:","vbscript:","file:"];for(const n of o)if(e.startsWith(n))return console.warn(`Blocked dangerous URL protocol: ${n}`),!1;return!0}function g(t,e){!t||!e||(f(e)?t.href=e:(console.error("Blocked unsafe URL:",e),t.href="#"))}function l(){const t=document.querySelector('meta[http-equiv="Content-Security-Policy"]'),e=document.querySelector('meta[name="Content-Security-Policy"]'),o=!!(t||e);return o||(console.warn("\u26A0 PAN Security: No Content-Security-Policy found"),console.warn("Add CSP meta tag or header for better security")),{configured:o,meta:t?t.content:null,header:e?e.content:null}}function h(t={}){const{enforceHTTPS:e=!0,checkCSP:o=!0}=t;console.log("\u{1F6E1}\uFE0F PAN Security initializing..."),e&&u(),o&&l(),console.log("\u2713 PAN Security initialized")}function x(t){if(!t||typeof t!="string")return"";const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,o=>e[o])}function m(t){if(!t||typeof t!="string")return"";const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}var C={enforceHTTPS:u,sanitizeHTML:y,safeSetHTML:P,createTextNode:T,createElement:H,isSafeURL:f,setSafeHref:g,checkCSP:l,initSecurity:h,escapeHTML:x,stripHTML:m};export{l as checkCSP,H as createElement,T as createTextNode,C as default,u as enforceHTTPS,x as escapeHTML,h as initSecurity,f as isSafeURL,P as safeSetHTML,y as sanitizeHTML,g as setSafeHref,m as stripHTML};
