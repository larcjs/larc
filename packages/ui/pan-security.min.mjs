function s(e={}){const{enforce:t=!0,allowedHosts:o=["localhost","127.0.0.1","[::1]"]}=e;if(!t)return;const n=location.protocol==="https:",r=location.hostname,c=o.some(i=>r===i);if(!n&&!c){console.error("ðŸ”’ PAN Security: HTTPS is required in production"),console.error(`Current URL: ${location.href}`),console.error("Redirecting to HTTPS...");const i=new URL(location.href);i.protocol="https:",location.replace(i.href)}}function f(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.textContent=e,t.innerHTML}function l(e,t){if(e){if(typeof t!="string"){e.textContent="";return}typeof window<"u"&&window.DOMPurify?e.innerHTML=window.DOMPurify.sanitize(t):(e.textContent=t,console.warn("DOMPurify not available. Using textContent. Install DOMPurify for proper HTML sanitization."))}}function p(e){return document.createTextNode(e||"")}function d(e,t={},o=""){const n=document.createElement(e);for(const[r,c]of Object.entries(t)){if(r.startsWith("on")){console.warn(`Skipping event handler attribute: ${r}`);continue}if(["innerHTML","outerHTML"].includes(r)){console.warn(`Skipping dangerous attribute: ${r}`);continue}n.setAttribute(r,c)}return o&&(n.textContent=o),n}function u(e){if(!e||typeof e!="string")return!1;const t=e.trim().toLowerCase(),o=["javascript:","data:","vbscript:","file:"];for(const n of o)if(t.startsWith(n))return console.warn(`Blocked dangerous URL protocol: ${n}`),!1;return!0}function S(e,t){!e||!t||(u(t)?e.href=t:(console.error("Blocked unsafe URL:",t),e.href="#"))}function a(){const e=document.querySelector('meta[http-equiv="Content-Security-Policy"]'),t=document.querySelector('meta[name="Content-Security-Policy"]'),o=!!(e||t);return o||(console.warn("âš  PAN Security: No Content-Security-Policy found"),console.warn("Add CSP meta tag or header for better security")),{configured:o,meta:e?e.content:null,header:t?t.content:null}}function y(e={}){const{enforceHTTPS:t=!0,checkCSP:o=!0}=e;console.log("ðŸ›¡ï¸ PAN Security initializing..."),t&&s(),o&&a(),console.log("âœ“ PAN Security initialized")}function T(e){if(!e||typeof e!="string")return"";const t={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return e.replace(/[&<>"']/g,o=>t[o])}function P(e){if(!e||typeof e!="string")return"";const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""}var H={enforceHTTPS:s,sanitizeHTML:f,safeSetHTML:l,createTextNode:p,createElement:d,isSafeURL:u,setSafeHref:S,checkCSP:a,initSecurity:y,escapeHTML:T,stripHTML:P};export{a as checkCSP,d as createElement,p as createTextNode,H as default,s as enforceHTTPS,T as escapeHTML,y as initSecurity,u as isSafeURL,l as safeSetHTML,f as sanitizeHTML,S as setSafeHref,P as stripHTML};
