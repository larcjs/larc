function c(t={}){const{enforce:e=!0,allowedHosts:o=["localhost","127.0.0.1","[::1]"]}=t;if(!e)return;const n=location.protocol==="https:",r=location.hostname,i=o.some(a=>r===a);!n&&!i&&(console.error("ðŸ”’ PAN Security: HTTPS is required in production"),console.error(`Current URL: ${location.href}`),console.error("Redirecting to HTTPS..."),location.replace(`https:${location.href.substring(location.protocol.length)}`))}function f(t){if(!t||typeof t!="string")return"";const e=document.createElement("div");return e.textContent=t,e.innerHTML}function l(t,e){if(t){if(typeof e!="string"){t.textContent="";return}typeof window<"u"&&window.DOMPurify?t.innerHTML=window.DOMPurify.sanitize(e):(t.textContent=e,console.warn("DOMPurify not available. Using textContent. Install DOMPurify for proper HTML sanitization."))}}function p(t){return document.createTextNode(t||"")}function d(t,e={},o=""){const n=document.createElement(t);for(const[r,i]of Object.entries(e)){if(r.startsWith("on")){console.warn(`Skipping event handler attribute: ${r}`);continue}if(["innerHTML","outerHTML"].includes(r)){console.warn(`Skipping dangerous attribute: ${r}`);continue}n.setAttribute(r,i)}return o&&(n.textContent=o),n}function s(t){if(!t||typeof t!="string")return!1;const e=t.trim().toLowerCase(),o=["javascript:","data:","vbscript:","file:"];for(const n of o)if(e.startsWith(n))return console.warn(`Blocked dangerous URL protocol: ${n}`),!1;return!0}function S(t,e){!t||!e||(s(e)?t.href=e:(console.error("Blocked unsafe URL:",e),t.href="#"))}function u(){const t=document.querySelector('meta[http-equiv="Content-Security-Policy"]'),e=document.querySelector('meta[name="Content-Security-Policy"]'),o=!!(t||e);return o||(console.warn("âš  PAN Security: No Content-Security-Policy found"),console.warn("Add CSP meta tag or header for better security")),{configured:o,meta:t?t.content:null,header:e?e.content:null}}function y(t={}){const{enforceHTTPS:e=!0,checkCSP:o=!0}=t;console.log("ðŸ›¡ï¸ PAN Security initializing..."),e&&c(),o&&u(),console.log("âœ“ PAN Security initialized")}function T(t){if(!t||typeof t!="string")return"";const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#039;"};return t.replace(/[&<>"']/g,o=>e[o])}function P(t){if(!t||typeof t!="string")return"";const e=document.createElement("div");return e.innerHTML=t,e.textContent||e.innerText||""}var g={enforceHTTPS:c,sanitizeHTML:f,safeSetHTML:l,createTextNode:p,createElement:d,isSafeURL:s,setSafeHref:S,checkCSP:u,initSecurity:y,escapeHTML:T,stripHTML:P};export{u as checkCSP,d as createElement,p as createTextNode,g as default,c as enforceHTTPS,T as escapeHTML,y as initSecurity,s as isSafeURL,l as safeSetHTML,f as sanitizeHTML,S as setSafeHref,P as stripHTML};
